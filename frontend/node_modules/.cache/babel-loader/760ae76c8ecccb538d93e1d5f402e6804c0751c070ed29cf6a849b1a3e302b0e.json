{"ast":null,"code":"const BASE = process.env.REACT_APP_API_BASE || 'http://localhost:8000/api';\nfunction authHeaders() {\n  const token = localStorage.getItem('token');\n  return token ? {\n    Authorization: `Bearer ${token}`\n  } : {};\n}\nexport async function getProductReviews(productId) {\n  const res = await fetch(`${BASE}/products/${productId}/reviews/`, {\n    credentials: 'include',\n    headers: {\n      Accept: 'application/json',\n      ...authHeaders()\n    }\n  });\n  if (!res.ok) throw new Error('Failed to fetch reviews');\n  return res.json(); // { reviews, average, count }\n}\nexport async function getReviewEligibility(productId) {\n  const res = await fetch(`${BASE}/products/${productId}/reviews/eligibility/`, {\n    credentials: 'include',\n    headers: {\n      Accept: 'application/json',\n      ...authHeaders()\n    }\n  });\n  if (!res.ok) throw new Error('Failed to check eligibility');\n  return res.json(); // { can_review, my_review? }\n}\nexport async function submitReview(productId, {\n  rating,\n  comment\n}) {\n  const res = await fetch(`${BASE}/products/${productId}/reviews/`, {\n    method: 'POST',\n    credentials: 'include',\n    headers: {\n      'Content-Type': 'application/json',\n      Accept: 'application/json',\n      ...authHeaders()\n    },\n    body: JSON.stringify({\n      rating,\n      comment\n    })\n  });\n  if (!res.ok) {\n    const msg = await res.text().catch(() => '');\n    throw new Error(msg || 'Failed to submit review');\n  }\n  return res.json();\n}","map":{"version":3,"names":["BASE","process","env","REACT_APP_API_BASE","authHeaders","token","localStorage","getItem","Authorization","getProductReviews","productId","res","fetch","credentials","headers","Accept","ok","Error","json","getReviewEligibility","submitReview","rating","comment","method","body","JSON","stringify","msg","text","catch"],"sources":["C:/VIET/PBL6/main/frontend/src/utils/reviewsApi.js"],"sourcesContent":["const BASE = process.env.REACT_APP_API_BASE || 'http://localhost:8000/api';\r\n\r\nfunction authHeaders() {\r\n  const token = localStorage.getItem('token');\r\n  return token ? { Authorization: `Bearer ${token}` } : {};\r\n}\r\n\r\nexport async function getProductReviews(productId) {\r\n  const res = await fetch(`${BASE}/products/${productId}/reviews/`, {\r\n    credentials: 'include',\r\n    headers: { Accept: 'application/json', ...authHeaders() }\r\n  });\r\n  if (!res.ok) throw new Error('Failed to fetch reviews');\r\n  return res.json(); // { reviews, average, count }\r\n}\r\n\r\nexport async function getReviewEligibility(productId) {\r\n  const res = await fetch(`${BASE}/products/${productId}/reviews/eligibility/`, {\r\n    credentials: 'include',\r\n    headers: { Accept: 'application/json', ...authHeaders() }\r\n  });\r\n  if (!res.ok) throw new Error('Failed to check eligibility');\r\n  return res.json(); // { can_review, my_review? }\r\n}\r\n\r\nexport async function submitReview(productId, { rating, comment }) {\r\n  const res = await fetch(`${BASE}/products/${productId}/reviews/`, {\r\n    method: 'POST',\r\n    credentials: 'include',\r\n    headers: {\r\n      'Content-Type': 'application/json',\r\n      Accept: 'application/json',\r\n      ...authHeaders()\r\n    },\r\n    body: JSON.stringify({ rating, comment })\r\n  });\r\n  if (!res.ok) {\r\n    const msg = await res.text().catch(() => '');\r\n    throw new Error(msg || 'Failed to submit review');\r\n  }\r\n  return res.json();\r\n}"],"mappings":"AAAA,MAAMA,IAAI,GAAGC,OAAO,CAACC,GAAG,CAACC,kBAAkB,IAAI,2BAA2B;AAE1E,SAASC,WAAWA,CAAA,EAAG;EACrB,MAAMC,KAAK,GAAGC,YAAY,CAACC,OAAO,CAAC,OAAO,CAAC;EAC3C,OAAOF,KAAK,GAAG;IAAEG,aAAa,EAAE,UAAUH,KAAK;EAAG,CAAC,GAAG,CAAC,CAAC;AAC1D;AAEA,OAAO,eAAeI,iBAAiBA,CAACC,SAAS,EAAE;EACjD,MAAMC,GAAG,GAAG,MAAMC,KAAK,CAAC,GAAGZ,IAAI,aAAaU,SAAS,WAAW,EAAE;IAChEG,WAAW,EAAE,SAAS;IACtBC,OAAO,EAAE;MAAEC,MAAM,EAAE,kBAAkB;MAAE,GAAGX,WAAW,CAAC;IAAE;EAC1D,CAAC,CAAC;EACF,IAAI,CAACO,GAAG,CAACK,EAAE,EAAE,MAAM,IAAIC,KAAK,CAAC,yBAAyB,CAAC;EACvD,OAAON,GAAG,CAACO,IAAI,CAAC,CAAC,CAAC,CAAC;AACrB;AAEA,OAAO,eAAeC,oBAAoBA,CAACT,SAAS,EAAE;EACpD,MAAMC,GAAG,GAAG,MAAMC,KAAK,CAAC,GAAGZ,IAAI,aAAaU,SAAS,uBAAuB,EAAE;IAC5EG,WAAW,EAAE,SAAS;IACtBC,OAAO,EAAE;MAAEC,MAAM,EAAE,kBAAkB;MAAE,GAAGX,WAAW,CAAC;IAAE;EAC1D,CAAC,CAAC;EACF,IAAI,CAACO,GAAG,CAACK,EAAE,EAAE,MAAM,IAAIC,KAAK,CAAC,6BAA6B,CAAC;EAC3D,OAAON,GAAG,CAACO,IAAI,CAAC,CAAC,CAAC,CAAC;AACrB;AAEA,OAAO,eAAeE,YAAYA,CAACV,SAAS,EAAE;EAAEW,MAAM;EAAEC;AAAQ,CAAC,EAAE;EACjE,MAAMX,GAAG,GAAG,MAAMC,KAAK,CAAC,GAAGZ,IAAI,aAAaU,SAAS,WAAW,EAAE;IAChEa,MAAM,EAAE,MAAM;IACdV,WAAW,EAAE,SAAS;IACtBC,OAAO,EAAE;MACP,cAAc,EAAE,kBAAkB;MAClCC,MAAM,EAAE,kBAAkB;MAC1B,GAAGX,WAAW,CAAC;IACjB,CAAC;IACDoB,IAAI,EAAEC,IAAI,CAACC,SAAS,CAAC;MAAEL,MAAM;MAAEC;IAAQ,CAAC;EAC1C,CAAC,CAAC;EACF,IAAI,CAACX,GAAG,CAACK,EAAE,EAAE;IACX,MAAMW,GAAG,GAAG,MAAMhB,GAAG,CAACiB,IAAI,CAAC,CAAC,CAACC,KAAK,CAAC,MAAM,EAAE,CAAC;IAC5C,MAAM,IAAIZ,KAAK,CAACU,GAAG,IAAI,yBAAyB,CAAC;EACnD;EACA,OAAOhB,GAAG,CAACO,IAAI,CAAC,CAAC;AACnB","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}